pamresult=pam(dist(data_agg_main),4)
names(pamresult)
table(aggregate(FAdata_agg,list(cutree(hc,4)),median),pamresult)
table(cutree(hc,4),pamresult)
table(cutree(hc,4),pamresult$clustering)
table(cutree(hc,3),pamresult$clustering)
pamresult=pam(dist(data_agg_main),3)
table(cutree(hc,3),pamresult$clustering)
plot(pamresult)
pamresult=pam(dist(data_agg_main),4)
plot(pamresult)
pamresult=pam(dist(data_agg_main),5)
plot(pamresult)
plot(silhouette(cutree(hc,4),dist(data_agg_main)))
aggregate(FAdata_agg,list(cutree(hc,3)),median)
A2Rplot(hc, k = 3, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
aggregate(FAdata_agg,list(cutree(hc,3)),mean)
aggregate(FAdata_agg,list(pamresult$clustering),mean)
pamresult=pam(dist(data_agg_main),3)
aggregate(FAdata_agg,list(pamresult$clustering),mean)
aggregate(data_agg_emp,list(pamresult$clustering),mean)
aggregate(data_agg_emp,list(cutree(hc,5)),median)
mclust(data_agg_main)
library(mclust)
install.packages("mclust")
mclust(data_agg_main)
library(mclust)
library(mclust)
mclust(data_agg_main)
fit<-Mclust(data_agg_main)
plot(fit)
dev.off()
plot(fit)
summary(fit)
fit<-Mclust(dist(data_agg_main)
)
fit<-kmeans(dist(data_agg_main),4)
library(cluster)
library(cluster)
clusplot(data_agg_main, fit$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
library(cluster)
clusplot(data_agg_main, fit$cluster, color=TRUE, shade=TRUE,
labels=1, lines=0)
)
)
library(fpc)
install.packages("fpc")
plotcluster(data_agg_main, fit$cluster)
library(fpc)
plotcluster(data_agg_main, fit$cluster)
?plotcluster
fit$cluster
aggregate(data_agg_emp,list(fit$cluster),median)
aggregate(data_agg_main,list(fit$cluster),median)
aggregate(FAdata_agg,list(fit$cluster),median)
hc = hclust(dist(FA_data_agg))
hc = hclust(dist(FAdata_agg))
plot(hc)
op = par(bg = "#EFEFEF")
A2Rplot(hc, k = 3, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
aggregate(FAdata_agg,list(hc$cluster),median)
aggregate(FAdata_agg,list(cutree(hc,k=3)),median)
aggregate(FAdata_agg,list(cutree(hc,k=4)),median)
fit<-kmeans(dist(FAdata_agg),4)
aggregate(FAdata_agg,list(fit$cluster),median)
ord<-cmdscale(dist(FAdata_agg))
ordiplot(ord)
library(vegan)
install.packages("vegan")
ordiplot(ord)
library(vegan)
ordiplot(ord)
ordiplot(ord)
fit<-kmeans(dist(FAdata_agg),4)
aggregate(FAdata_agg,list(fit$cluster),median)
plot(fit)
plotcluster(data_agg_main, fit$cluster)
plotcluster(data_agg_main, fit$cluster)
?plotcluster
with(FAdata_agg, pairs(fit$cluster,))
with(FAdata_agg, pairs(FAdata_agg,fit$cluster))
pairs(FAdata_agg,fit$cluster)
dev.off()
pairs(FAdata_agg,fit$cluster)
pairs(FAdata_agg,col=c(1:3)[fit$cluster])
pairs(FAdata_agg,col=c(1:4)[fit$cluster])
fit<-kmeans(dist(FAdata_agg),3)
pairs(FAdata_agg,col=c(1:3)[fit$cluster])
fit<-kmeans(dist(FAdata_agg),4)
pairs(FAdata_agg,col=c(1:4)[fit$cluster])
hc = hclust(dist(FAdata_agg))
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
hist(data_agg_emp)
hist(rowMeans(data_agg_emp)
)
hist(rowMeans(data_agg_emp, breaks=25, main="Average Satisfaction")
)
dev.off()
hist(rowMeans(data_agg_emp, breaks=25, main="Average Satisfaction")
)
hist(rowMeans(data_agg_emp), breaks=25, main="Average Satisfaction")
hist(rowMeans(data_agg_emp[c("A_Q07","A_Q08")]), breaks=25, main="Average Satisfaction")
hist(rowMeans(data_agg_emp[c("A_Q07","A_Q08")]), breaks=25, main="Average Satisfaction",probability=TRUE, col="gray", border="white")
hist(rowMeans(data_agg_emp[c("A_Q07","A_Q08")]), breaks=25, main="Average Satisfaction",probability=TRUE, col="gray", border="white",xlab="",)
hist(rowMeans(data_agg_emp[c("A_Q07","A_Q08")]), breaks=25, main="Work Satisfaction",probability=TRUE, col="gray", border="white",xlab="",)
hist(rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")]), breaks=25, main="Dept/Agency Satisfaction",probability=TRUE, col="gray", border="white",xlab="")
ggplot
plotdata<-cbind(data_agg_emp, FAdata_agg)
ggplot(plotdata, aes("A_Q08","FA1",color=fit$cluster))
ggplot(plotdata, aes("A_Q08","FA1",color=fit$cluster)) + geom_point()
ggplot(plotdata, aes(A_Q08,FA1,color=fit$cluster)) + geom_point()
data_agg_emp_work=rowMeans(data_agg_emp[c("A_Q07","A_Q08")])
data_agg_emp_dept=rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")])
aggregate(data_agg_emp_work, list(fit$cluster), mean)
aggregate(data_agg_emp_dept, list(fit$cluster), mean)
aggregate(fAdata_agg, list(fit$cluster), mean)
aggregate(FAdata_agg, list(fit$cluster), mean)
fit$cluster
fit
fit$cluster =4
fit$cluster=4
fit$cluster
fit<-kmeans(dist(FAdata_agg),4)
fit$cluster
fit$cluster(fit$cluster==1)
fit$cluster==1
FAdata_agg[fit$cluster==1]
FAdata_agg
FAdata_agg$FA1[fit$cluster==1]
rownames(FAdata_agg[fit$cluster==1])
rownames(FAdata_agg$FA1[fit$cluster==1])
FAdata_agg$rownames[fit$cluster==1]
rownames(subset(FAdata_agg, fit$cluster==1))
rownames(subset(FAdata_agg, fit$cluster==2))
rownames(subset(FAdata_agg, fit$cluster==3))
rownames(subset(FAdata_agg, fit$cluster==4))
pairs(FAdata_agg,col=c(1:4)[fit$cluster])
pairs(FAdata_agg,col=c(1:4)[fit$cluster])
pairs(FAdata_agg,col=c(1:4)[fit$cluster])
hc = hclust(dist(FAdata_agg))
pairs(FAdata_agg,col=c(1:4)[hc$cluster])
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
pairs(FAdata_agg,col=c(1:4)[cutree(hc,5)])
pairs(FAdata_agg,col=c(1:4)[cutree(hc,6)])
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
hc = hclust(dist(FAdata_agg))
op = par(bg = "#EFEFEF")
A2Rplot(hc, k = 3, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
A2Rplot(hc, k = 4, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
A2Rplot(hc, k = 4, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
A2Rplot(hc, k = 1, boxes = FALSE, col.up = "gray50",
A2Rplot(hc, k = 1, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
A2Rplot(hc, k = 2, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
dev.off()
A2Rplot(hc, k = 2, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
dev.off()
A2Rplot(hc, k = 4, boxes = FALSE, col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
A2Rplot(hc, k = 2, boxes = FALSE, main="",col.up = "gray50",
col.down = c("#FF6B6B", "#4ECDC4", "#556270"))
pairs(FAdata_agg,col=c(1:4)[cutree(hc,4)])
data=read.csv("/Users/hahu/Data/NPLChallenge/data_raw/survey_by_dept.csv")
data_agg=read.csv("/Users/hahu/Data/NPLChallenge/data_raw/survey_aggregated_dept.csv",row.names = 1)
data_emp <- data[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_emp2 <- data[c("A_Q07","A_Q08","A_Q11","F_Q51","F_Q52","F_Q53")]
data_main<-data[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_main<-data_agg[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_emp<-data_agg[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_agg_emp_work=rowMeans(data_agg_emp[c("A_Q07","A_Q08")])
data_agg_emp_dept=rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")])
scree(data_main)
fa.parallel(data_main)
library(psych)
library(RColorBrewer)
scree(data_emp)
fa.parallel(data_emp)
scree(data_main)
fa.parallel(data_main)
data_emp_fa=fa(data_emp,nfactors=2,rotate="varimax")
data_main_fa=fa(data_main,nfactors=8, rotate="varimax")
#regression
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_emp_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
summary(fit2)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
data_emp_fa=fa(data_emp,nfactors=2,rotate="varimax")
data_main_fa=fa(data_main,nfactors=8, rotate="varimax")
data_main_scores<-data_main_fa$scores
print(data_emp_fa$loadings)
print(data_main_fa$loadings, cutoff=0.5)
#regression
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
print(data_main_fa$loadings, cutoff=0.5)
y2=rowMeans(subset(data_emp,select=c("F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
#regression
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
fit2<-lm(y~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
data_main_scores<-data_main_fa$scores
par(mfrow=c(3,3))
colnames<-dimnames(data_main_scores)[[2]]
for (i in 1:8){
hist(data_main_scores[,i],main=colnames[i], xlab="", probability=TRUE, col="gray", border="white")
d<-density(data_main_scores[,i])
lines(d, col="red")
}
data_main_scores<-data_main_fa$scores
par(mfrow=c(3,3))
colnames<-dimnames(data_main_scores)[[2]]
for (i in 1:8){
hist(data_main_scores[,i],main=colnames[i], xlab="", probability=TRUE, col="gray", border="white")
d<-density(data_main_scores[,i])
lines(d, col="red")
}
data=read.csv("/Users/hahu/Data/NPLChallenge/data_raw/survey_by_dept.csv")
data_agg=read.csv("/Users/hahu/Data/NPLChallenge/data_raw/survey_aggregated_dept.csv",row.names = 1)
data=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_by_dept.csv")
data_agg=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_aggregated_dept.csv",row.names = 1)
data_emp <- data[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_emp2 <- data[c("A_Q07","A_Q08","A_Q11","F_Q51","F_Q52","F_Q53")]
data_main<-data[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_main<-data_agg[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_emp<-data_agg[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_agg_emp_work=rowMeans(data_agg_emp[c("A_Q07","A_Q08")])
data_agg_emp_dept=rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")])
data_emp_fa=fa(data_emp,nfactors=2,rotate="varimax")
data_main_fa=fa(data_main,nfactors=8, rotate="varimax")
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
data_main_scores<-data_main_fa$scores
par(mfrow=c(3,3))
colnames<-dimnames(data_main_scores)[[2]]
for (i in 1:8){
hist(data_main_scores[,i],main=colnames[i], xlab="", probability=TRUE, col="gray", border="white")
d<-density(data_main_scores[,i])
lines(d, col="red")
}
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
#regression
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
fit2<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
fitdata<-cbind(y,y1,y2,data_main_scores)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
fitdata
fitdata$MR3
fitdata.MR3
data=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_by_dept.csv")
data_agg=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_aggregated_dept.csv",row.names = 1)
data_emp <- data[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_main<-data[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_main<-data_agg[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_emp<-data_agg[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_agg_emp_work=rowMeans(data_agg_emp[c("A_Q07","A_Q08")])
data_agg_emp_dept=rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")])
hist(rowMeans(data_agg_emp[c("A_Q07","A_Q08")]), breaks=25, main="Work Satisfaction",probability=TRUE, col="gray", border="white",xlab="")
hist(rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")]), breaks=25, main="Dept/Agency Satisfaction",probability=TRUE, col="gray", border="white",xlab="")
scree(data_main)
fa.parallel(data_main)
data_main
data
data=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_by_dept.csv")
dat
data
data=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_by_dept.csv")
dev.off()
data_agg=read.csv("/Users/hahu/Data/NPLChallenge/data/survey_aggregated_dept.csv",row.names = 1)
data_emp <- data[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_emp2 <- data[c("A_Q07","A_Q08","A_Q11","F_Q51","F_Q52","F_Q53")]
data_main<-data[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_main<-data_agg[c("A_Q05","A_Q09","A_Q10","A_Q12","A_Q13","A_Q15","A_Q16","A_Q17","B_Q20","B_Q22","B_Q23","C_Q24","C_Q27","C_Q28","D_Q30","D_Q31","D_Q32","D_Q34","E_Q35","E_Q36","F_Q37","F_Q38","F_Q40","F_Q41","F_Q42","F_Q44","F_Q45","F_Q46","F_Q47","F_Q48","F_Q49","F_Q50","H_Q61","J_Q69")]
data_agg_emp<-data_agg[c("A_Q07","A_Q08","F_Q51","F_Q52","F_Q53")]
data_agg_emp_work=rowMeans(data_agg_emp[c("A_Q07","A_Q08")])
data_agg_emp_dept=rowMeans(data_agg_emp[c("F_Q51","F_Q52","F_Q53")])
#factor analysis
data_emp_fa=fa(data_emp,nfactors=2,rotate="varimax")
data_main_fa=fa(data_main,nfactors=8, rotate="varimax")
data_main_scores<-data_main_fa$scores
par(mfrow=c(3,3))
colnames<-dimnames(data_main_scores)[[2]]
for (i in 1:8){
hist(data_main_scores[,i],main=colnames[i], xlab="", probability=TRUE, col="gray", border="white")
d<-density(data_main_scores[,i])
lines(d, col="red")
}
dev.off()
#print
print(data_emp_fa$loadings)
print(data_main_fa$loadings, cutoff=0.5)
y<-rowMeans(data_emp)
y1=rowMeans(subset(data_emp,select=c("A_Q07","A_Q08")))
y2=rowMeans(subset(data_emp,select=c("F_Q51","F_Q52","F_Q53")))
fitdata<-cbind(y,y1,y2,data_main_scores)
fit<-lm(y1~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit)
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
y2
#plot correlation coefficient matrix
palette <- colorRampPalette(c("white", "red"), space = "rgb")
jet.colors <-
colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
"#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
redblue <- colorRampPalette( colors = brewer.pal(9,"BuRd") )
levelplot(cor(data_emp_fa$scores),xlab="", ylab="", col.regions=rev(redblue(200)), at=seq(-1,1,0.01))
library(psych)
library(RColorBrewer)
levelplot(cor(data_emp_fa$scores),xlab="", ylab="", col.regions=rev(redblue(200)), at=seq(-1,1,0.01))
library(psych)
library(psych)
library(RColorBrewer)
library(lattice)
dev.off()
#plot correlation coefficient matrix
palette <- colorRampPalette(c("white", "red"), space = "rgb")
jet.colors <-
colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
"#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
redblue <- colorRampPalette( colors = brewer.pal(9,"BuRd") )
levelplot(cor(data_emp_fa$scores),xlab="", ylab="", col.regions=rev(redblue(200)), at=seq(-1,1,0.01))
#plot regression coefficient graph
#code from: http://www.carlislerainey.com/2012/06/30/coefficient-plots-in-r/
varnames<-c("Senior Management","Employee \"Enabler\"","Resolve Conflict","Immediate Supervisor","Hiring Competent Colleagues","Career Path","Work-Life Balance","Others")
par(
family = "serif",
oma = c(0,0,0,0),
mar = c(5,2,4,2)  # margins adjusted to reflect changing the locations of the labels
)
plot(NULL,
xlim = c(-1, 6),
ylim = c(.7, length(varnames) + .4),
axes = F, xlab = NA, ylab = NA)
#plot regression coefficient graph
#code from: http://www.carlislerainey.com/2012/06/30/coefficient-plots-in-r/
varnames<-c("Senior Management","Employee \"Enabler\"","Resolve Conflict","Immediate Supervisor","Hiring Competent Colleagues","Career Path","Work-Life Balance","Others")
par(
family = "serif",
oma = c(0,0,0,0),
mar = c(5,2,4,2)  # margins adjusted to reflect changing the locations of the labels
)
plot(NULL,
xlim = c(-1, 6),
ylim = c(.7, length(varnames) + .4),
axes = F, xlab = NA, ylab = NA)
est <- coef(fit)[-1]
se <- sqrt(diag(vcov(fit)))[-1]
for (i in 1:length(est)) {
points(est[i], i, pch = 19, cex = .5)
lines(c(est[i] + 1.64*se[i], est[i] - 1.64*se[i]), c(i, i))
lines(c(est[i] + .67*se[i], est[i] - .67*se[i]), c(i, i), lwd = 3)
text(est[i], i, varnames[i], xpd = T, cex = .8, pos = 3)           # add variable labels above the points
}
varnames<-c("Senior Management","Employee \"Enabler\"","Resolve Conflict","Immediate Supervisor","Hiring Competent Colleagues","Career Path","Work-Life Balance","Others")
par(
family = "serif",
oma = c(0,0,0,0),
mar = c(5,2,4,2)  # margins adjusted to reflect changing the locations of the labels
)
plot(NULL,
xlim = c(-1, 6),
ylim = c(.7, length(varnames) + .4),
axes = F, xlab = NA, ylab = NA)
est <- coef(fit)[-1]
se <- sqrt(diag(vcov(fit)))[-1]
for (i in 1:length(est)) {
points(est[i], i, pch = 19, cex = .5)
lines(c(est[i] + 1.64*se[i], est[i] - 1.64*se[i]), c(i, i))
lines(c(est[i] + .67*se[i], est[i] - .67*se[i]), c(i, i), lwd = 3)
text(est[i], i, varnames[i], xpd = T, cex = .8, pos = 3)           # add variable labels above the points
}
axis(side = 1)
abline(v = 0, lty = 3, col = "grey")
mtext(side = 1, "Linear Regression Coefficient", line = 3)
mtext(side = 3, "Linear Regression Model: Employee Satisfaction with Work", line = 1)
box()
#second plot
dev.off()
varnames<-c("Senior Management","Employee \"Enabler\"","Resolve Conflict","Immediate Supervisor","Hiring Competent Colleagues","Career Path","Work-Life Balance","Others")
par(
family = "serif",
oma = c(0,0,0,0),
mar = c(5,2,4,2)  # margins adjusted to reflect changing the locations of the labels
)
plot(NULL,
xlim = c(-1, 6),
ylim = c(.7, length(varnames) + .4),
axes = F, xlab = NA, ylab = NA)
est <- coef(fit2)[-1]
se <- sqrt(diag(vcov(fit2)))[-1]
for (i in 1:length(est)) {
points(est[i], i, pch = 19, cex = .5)
lines(c(est[i] + 1.64*se[i], est[i] - 1.64*se[i]), c(i, i))
lines(c(est[i] + .67*se[i], est[i] - .67*se[i]), c(i, i), lwd = 3)
text(est[i], i, varnames[i], xpd = T, cex = .8, pos = 3)           # add variable labels above the points
}
axis(side = 1)
abline(v = 0, lty = 3, col = "grey")
mtext(side = 1, "Linear Regression Coefficient", line = 3)
mtext(side = 3, "Linear Regression Model: Employee Satisfaction with Department", line = 1)
box()
varnames<-c("Senior Management","Employee \"Enabler\"","Resolve Conflict","Immediate Supervisor","Hiring Competent Colleagues","Career Path","Work-Life Balance","Others")
par(
family = "serif",
oma = c(0,0,0,0),
mar = c(5,2,4,2)  # margins adjusted to reflect changing the locations of the labels
)
plot(NULL,
xlim = c(-1, 6),
ylim = c(.7, length(varnames) + .4),
axes = F, xlab = NA, ylab = NA)
est <- coef(fit)[-1]
se <- sqrt(diag(vcov(fit)))[-1]
for (i in 1:length(est)) {
points(est[i], i, pch = 19, cex = .5)
lines(c(est[i] + 1.64*se[i], est[i] - 1.64*se[i]), c(i, i))
lines(c(est[i] + .67*se[i], est[i] - .67*se[i]), c(i, i), lwd = 3)
text(est[i], i, varnames[i], xpd = T, cex = .8, pos = 3)           # add variable labels above the points
}
axis(side = 1)
abline(v = 0, lty = 3, col = "grey")
mtext(side = 1, "Linear Regression Coefficient", line = 3)
mtext(side = 3, "Linear Regression Model: Employee Satisfaction with Work", line = 1)
box()
fit2<-lm(y2~MR3+MR1+MR6+MR2+MR5+MR8+MR7+MR4, data=data.frame(fitdata))
summary(fit2)
tsdata = read.csv("/User/hahu/Data/walmart/train.csv")
tsdata = read.csv("/Users/hahu/Data/walmart/train.csv")
head(tsdata)
rawdata = read.csv("/Users/hahu/Data/walmart/train.csv")
tsdata = ts(data=rawdata$Weekly_Sales, frequency = 52, start=c(2010,2), end=c(2012,10))
start(tsdata)
tsdata
install.package('KernSmooth')
package.install('KernSmooth')
install.packages('KernSmooth')
library('KernSmooth')
data=read.csv("household_power_consumption.txt")
pwd
getwd()
setwd("~/Data/coursera/git/ExData_Plotting1/")
data=read.csv("household_power_consumption.txt")
data
